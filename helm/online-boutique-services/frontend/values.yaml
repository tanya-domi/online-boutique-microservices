deploymentName: frontend-deployment
serviceName: frontend
appLabel: frontend
appName: frontend
serviceAccountName: frontend

replicaCount: 1

image:
  repository: registry.gitlab.com/seunayolu/gitops-frontend/frontend
  tag: "0ada6df3"
  pullPolicy: IfNotPresent
  imagePullSecrets:
    - name: my-registry-key

annotations:
  sidecar.istio.io/rewriteAppHTTPProbers: "true"

securityContext:
  fsGroup: 1000
  runAsGroup: 1000
  runAsNonRoot: true
  runAsUser: 1000

containers:
  - name: server
    securityContext:
      allowPrivilegeEscalation: false
      capabilities:
        drop:
          - ALL
      privileged: false
      readOnlyRootFilesystem: true
    ports:
      - containerPort: 8080
    readinessProbe:
      initialDelaySeconds: 10
      httpGet:
        path: "/_healthz"
        port: 8080
        httpHeaders:
          - name: "Cookie"
            value: "shop_session-id=x-readiness-probe"
    livenessProbe:
      initialDelaySeconds: 10
      httpGet:
        path: "/_healthz"
        port: 8080
        httpHeaders:
          - name: "Cookie"
            value: "shop_session-id=x-liveness-probe"
    env:
      - name: PORT
        value: "8080"
      - name: PRODUCT_CATALOG_SERVICE_ADDR
        value: "productcatalogservice:3550"
      - name: CURRENCY_SERVICE_ADDR
        value: "currencyservice:7000"
      - name: CART_SERVICE_ADDR
        value: "cartservice:7070"
      - name: RECOMMENDATION_SERVICE_ADDR
        value: "recommendationservice:8080"
      - name: SHIPPING_SERVICE_ADDR
        value: "shippingservice:50051"
      - name: CHECKOUT_SERVICE_ADDR
        value: "checkoutservice:5050"
      - name: AD_SERVICE_ADDR
        value: "adservice:9555"
      - name: SHOPPING_ASSISTANT_SERVICE_ADDR
        value: "shoppingassistantservice:80"
      - name: ENABLE_PROFILER
        value: "0"
    resources:
      requests:
        cpu: 100m
        memory: 64Mi
      limits:
        cpu: 200m
        memory: 128Mi

service:
  type: ClusterIP
  ports:
    - name: http
      port: 80
      targetPort: 8080

ingress:
  enabled: true
  name: online-boutique
  className: alb
  scheme: internet-facing
  targetType: ip
  certificateArn: arn:aws:acm:eu-north-1:381492137122:certificate/4a115c36-439e-4981-8be2-6020324e3400
spec:
  listenPorts: '[{"HTTP": 80}, {"HTTPS": 443}]'
  sslRedirect: "443"
  groupName: online-boutique
  host: online-boutique-dev.dominicsheytanya.org
  backend:
    serviceName: frontend
    portNumber: 80

createServiceAccount: true
profiler_enabled:  true
